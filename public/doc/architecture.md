# ğŸ“š æ¡†æ¶ä»‹ç»

## è®¾è®¡æ€æƒ³

> ç›®æ ‡ï¼šğŸ“‰ é™ä½å¼€å‘è€…è®¤çŸ¥å¤æ‚åº¦ï¼ŒğŸ“ˆ æé«˜å¼€å‘ä¸åä½œæ•ˆç‡ã€‚

### ä¾èµ–æ³¨å…¥/æ§åˆ¶åè½¬ï¼ˆ`IOC` & `DI`ï¼‰

> æ§åˆ¶åè½¬ `IOC`ï¼ˆInversion of Controlï¼‰

æ‰€è°“ `IOC`ï¼Œå¯¹äº `Nest-Server` æ¥è¯´ï¼Œå°±æ˜¯ç”± `CoreModule` æ¥è´Ÿè´£æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ï¼Œ è¿™æ˜¯ `Nest-Server` çš„æ ¸å¿ƒï¼Œè´¯ç©¿å§‹ç»ˆã€‚

è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•æ‰¾å¥³æœ‹å‹çš„ï¼Ÿå¸¸è§çš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬åˆ°å¤„å»çœ‹å“ªé‡Œæœ‰é•¿å¾—æ¼‚äº®èº«æåˆå¥½çš„mmï¼Œç„¶åæ‰“å¬å¥¹ä»¬çš„å…´è¶£çˆ±å¥½ã€qqå·ã€ç”µè¯å·ï¼Œæƒ³åŠæ³•è®¤è¯†å¥¹ä»¬ï¼ŒæŠ•å…¶æ‰€å¥½é€å…¶æ‰€è¦ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¤æ‚æ·±å¥¥çš„ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±è®¾è®¡å’Œé¢å¯¹æ¯ä¸ªç¯èŠ‚ã€‚ä¼ ç»Ÿçš„ç¨‹åºå¼€å‘ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨å¦å¤–çš„å¯¹è±¡ï¼Œå°±å¿…é¡»å¾—åˆ°å®ƒï¼ˆè‡ªå·± new ä¸€ä¸ªï¼‰ï¼Œä½¿ç”¨å®Œä¹‹åè¿˜è¦å°†å¯¹è±¡é”€æ¯ï¼ˆæ¯”å¦‚ Connection ç­‰ï¼‰ï¼Œå¯¹è±¡å§‹ç»ˆä¼šå’Œå…¶ä»–çš„æ¥å£æˆ–ç±»è—•åˆèµ·æ¥ã€‚

![FULL](../images/FULL.png)

é‚£ä¹ˆ `CoreModule` æ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿæœ‰ç‚¹åƒé€šè¿‡å©šä»‹æ‰¾å¥³æœ‹å‹ï¼Œåœ¨æˆ‘å’Œå¥³æœ‹å‹ä¹‹é—´å¼•å…¥äº†ä¸€ä¸ªç¬¬ä¸‰è€…ï¼šå©šå§»ä»‹ç»æ‰€ã€‚å©šä»‹ç®¡ç†äº†å¾ˆå¤šç”·ç”·å¥³å¥³çš„èµ„æ–™ï¼Œæˆ‘å¯ä»¥å‘å©šä»‹æå‡ºä¸€ä¸ªåˆ—è¡¨ï¼Œå‘Šè¯‰å®ƒæˆ‘æƒ³æ‰¾ä¸ªä»€ä¹ˆæ ·çš„å¥³æœ‹å‹ï¼Œæ¯”å¦‚é•¿å¾—åƒæå˜‰æ¬£ï¼Œèº«æåƒæ—ç†™é›·ï¼Œå”±æ­Œåƒå‘¨æ°ä¼¦ï¼Œé€Ÿåº¦åƒå¡æ´›æ–¯ï¼ŒæŠ€æœ¯åƒé½è¾¾å†…ä¹‹ç±»çš„ï¼Œç„¶åå©šä»‹å°±ä¼šæŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚ï¼Œæä¾›ä¸€ä¸ªmmï¼Œæˆ‘ä»¬åªéœ€è¦å»å’Œå¥¹è°ˆæ‹çˆ±ã€ç»“å©šå°±è¡Œäº†ã€‚ç®€å•æ˜äº†ï¼Œå¦‚æœå©šä»‹ç»™æˆ‘ä»¬çš„äººé€‰ä¸ç¬¦åˆè¦æ±‚ï¼Œæˆ‘ä»¬å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸å†ç”±æˆ‘è‡ªå·±æ§åˆ¶ï¼Œè€Œæ˜¯æœ‰å©šä»‹è¿™æ ·ä¸€ä¸ªç±»ä¼¼å®¹å™¨çš„æœºæ„æ¥æ§åˆ¶ã€‚`Nest-Server` æ‰€å€¡å¯¼çš„å¼€å‘æ–¹å¼å°±æ˜¯å¦‚æ­¤ï¼Œæ‰€æœ‰çš„æ¨¡å—éƒ½ä¼šåœ¨ `CoreModule` ä¸­ç™»è®°ï¼Œå‘Šè¯‰ `CoreModule` ä½ æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œä½ éœ€è¦ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶å  `CoreModule` ä¼šåœ¨ç³»ç»Ÿè¿è¡Œåˆ°é€‚å½“çš„æ—¶å€™ï¼ŒæŠŠä½ è¦çš„ä¸œè¥¿ä¸»åŠ¨ç»™ä½ ï¼ŒåŒæ—¶ä¹ŸæŠŠä½ äº¤ç»™å…¶ä»–éœ€è¦ä½ çš„ä¸œè¥¿ã€‚

![IOC](../images/IOC.png)

æ‰€æœ‰çš„ç±»çš„åˆ›å»ºã€é”€æ¯éƒ½ç”± `CoreModule` æ¥æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ§åˆ¶å¯¹è±¡ç”Ÿå­˜å‘¨æœŸçš„ä¸å†æ˜¯å¼•ç”¨å®ƒçš„å¯¹è±¡ï¼Œè€Œæ˜¯ `CoreModule`  ã€‚å¯¹äºæŸä¸ªå…·ä½“çš„å¯¹è±¡è€Œè¨€ï¼Œä»¥å‰æ˜¯å®ƒæ§åˆ¶å…¶ä»–å¯¹è±¡ï¼Œç°åœ¨æ˜¯æ‰€æœ‰å¯¹è±¡éƒ½è¢« `CoreModule` æ§åˆ¶ï¼Œæ‰€ä»¥è¿™å«æ§åˆ¶åè½¬ã€‚

> ä¾èµ–æ³¨å…¥ `DI`ï¼ˆDependency Injectionï¼‰

`IOC` çš„ä¸€ä¸ªé‡ç‚¹æ˜¯åœ¨ç³»ç»Ÿè¿è¡Œä¸­ï¼ŒåŠ¨æ€çš„å‘æŸä¸ªå¯¹è±¡æä¾›å®ƒæ‰€éœ€è¦çš„å…¶ä»–å¯¹è±¡ã€‚è¿™ä¸€ç‚¹æ˜¯é€šè¿‡`DI`æ¥å®ç°çš„ã€‚

æ¯”å¦‚å¯¹è±¡ A éœ€è¦æ“ä½œæ•°æ®åº“ï¼Œä»¥å‰æˆ‘ä»¬æ€»æ˜¯è¦åœ¨ A ä¸­è‡ªå·±ç¼–å†™ä»£ç æ¥è·å¾—ä¸€ä¸ª Connection å¯¹è±¡ï¼Œè€Œç°åœ¨ï¼Œæˆ‘ä»¬å°±åªéœ€è¦å‘Šè¯‰ `CoreModule`ï¼ŒAä¸­éœ€è¦ä¸€ä¸ª Connectionï¼Œè‡³äºè¿™ä¸ª Connection æ€ä¹ˆæ„é€ ï¼Œä½•æ—¶æ„é€ ï¼ŒA ä¸éœ€è¦çŸ¥é“ã€‚åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ï¼Œ `CoreModule` ä¼šåœ¨é€‚å½“çš„æ—¶å€™åˆ¶é€ ä¸€ä¸ª Connectionï¼Œç„¶ååƒæ‰“é’ˆä¸€æ ·ï¼Œæ³¨å°„åˆ° A å½“ä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†å¯¹å„ä¸ªå¯¹è±¡ä¹‹é—´å…³ç³»çš„æ§åˆ¶ã€‚A éœ€è¦ä¾èµ– Connection æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œè€Œè¿™ä¸ª Connection æ˜¯ç”± `CoreModule` æ³¨å…¥åˆ° A ä¸­çš„ï¼Œä¾èµ–æ³¨å…¥çš„åå­—å°±è¿™ä¹ˆæ¥çš„ã€‚é‚£ä¹ˆ `DI` æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ `Nest-Server` çš„ä¸€ä¸ªé‡è¦ç‰¹å¾å°±æ˜¯åå°„ï¼ˆreflectionï¼‰ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€çš„ç”Ÿæˆå¯¹è±¡ã€æ‰§è¡Œå¯¹è±¡çš„æ–¹æ³•ã€æ”¹å˜å¯¹è±¡çš„å±æ€§ï¼Œ`CoreModule` å°±æ˜¯é€šè¿‡åå°„æ¥å®ç°æ³¨å…¥çš„ã€‚

ç†è§£äº† `IOC` å’Œ`DI`çš„æ¦‚å¿µåï¼Œä¸€åˆ‡éƒ½å°†å˜å¾—ç®€å•æ˜äº†ï¼Œå‰©ä¸‹çš„å·¥ä½œåªä¸è¿‡æ˜¯åœ¨ `CoreModule` ä¸­å †ç§¯æœ¨è€Œå·² ğŸ˜

![IOC-IDEA](../images/IOC-IDEA.png)

### é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰

> é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject Oriented Programmingï¼ŒOOPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³

é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä»¥å¯¹è±¡ä¸ºæ ¸å¿ƒï¼Œè¯¥æ–¹æ³•è®¤ä¸ºç¨‹åºç”±ä¸€ç³»åˆ—å¯¹è±¡ç»„æˆã€‚ç±»æ˜¯å¯¹ç°å®ä¸–ç•Œçš„æŠ½è±¡ï¼ŒåŒ…æ‹¬è¡¨ç¤ºé™æ€å±æ€§çš„æ•°æ®å’Œå¯¹æ•°æ®çš„æ“ä½œï¼Œå¯¹è±¡æ˜¯ç±»çš„å®ä¾‹åŒ–ã€‚å¯¹è±¡é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’ç›¸äº’é€šä¿¡ï¼Œæ¥æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­ä¸åŒå®ä½“é—´çš„è”ç³»ã€‚åœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œå¯¹è±¡æ˜¯ç»„æˆç¨‹åºçš„åŸºæœ¬æ¨¡å—ã€‚

![OOP](../images/OOP.png)

> OOP çš„æœ¬è´¨æ˜¯ä¸ºäº†å¤„ç†å¤§å‹å¤æ‚ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°ã€‚OOPçš„ä¼˜åŠ¿ä¸€å®šè¦åˆ°äº†æ ¹æœ¬å°±ä¸å¯èƒ½æœ‰ä¸€ä¸ªâ€œä¸Šå¸è§†è§’â€çš„å­˜åœ¨ï¼Œä¸å¾—ä¸æŠŠç³»ç»Ÿæ‹†æˆå¾ˆå¤š Object æ—¶æ‰ä¼šä½“ç°å‡ºæ¥ã€‚

ä¸ºä»€ä¹ˆ OOP èƒ½å¤Ÿæ”¯æ’‘åºå¤§å¤æ‚çš„ç³»ç»Ÿå‘¢ï¼Ÿç”¨å¼€å…¬å¸ä¸¾ä¸ªä¾‹å­ã€‚å¦‚æœå…¬å¸å°±åªæœ‰å‡ ä¸ªäººï¼Œé‚£ä¹ˆå¤§å®¶æ€»æ˜¯ä¸€èµ·å¹²æ´»ï¼Œå·¥ä½œå¯ä»¥é€šè¿‡â€œä¸Šå¸è§†è§’â€œå®Œå…¨ææ¸…æ¥šæ¯ä¸€ä¸ªç»†èŠ‚ï¼Œäºæ˜¯å¯ä»¥åˆ¶å®šéå¸¸æ¸…æ™°çš„ã€æ˜ç¡®çš„æµç¨‹æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚è¿™ä¸ªæ€æƒ³æ¥è¿‘äºä¼ ç»Ÿçš„é¢å‘è¿‡ç¨‹ç¼–ç¨‹ã€‚è€Œå¦‚æœå…¬å¸äººæ•°å˜å¤šï¼Œè¾¾åˆ°å‡ ç™¾ä¸Šåƒï¼Œè¿™ç§â€œä¸Šå¸è§†è§’â€æ˜¯å®Œå…¨ä¸å¯è¡Œçš„ã€‚åœ¨è¿™æ ·å¤æ‚çš„å…¬å¸é‡Œï¼Œæ²¡æœ‰ä¸€ä¸ªäººèƒ½ææ¸…æ¥šä¸€ä¸ªå·¥ä½œçš„æ‰€æœ‰ç»†èŠ‚ã€‚ä¸ºæ­¤ï¼Œå…¬å¸è¦åˆ†å¾ˆå¤šä¸ªéƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨ç›¸å¯¹çš„ç‹¬ç«‹ï¼Œæœ‰è‡ªå·±çš„ç« ç¨‹ï¼ŒåŠäº‹æ–¹æ³•å’Œè§„åˆ™ç­‰ã€‚ç‹¬ç«‹æ€§å°±æ„å‘³ç€â€œéšè—å†…éƒ¨çŠ¶æ€â€ã€‚æ¯”å¦‚ä½ åªèƒ½è¯´ç”³è¯·è®©æŸéƒ¨é—¨æŒ‰ç…§ç« ç¨‹åŠä¸€ä»¶äº‹ï¼Œå´ä¸èƒ½è¯´å‘½ä»¤éƒ¨é—¨é‡Œçš„è°è°è°ï¼Œåœ¨ä»€ä¹ˆæ—¶å€™ä¹‹å‰ä¸€å®šè¦åŠæˆã€‚è¿™äº›å†…éƒ¨çš„ç»†èŠ‚ä½ ç®¡ä¸ç€ã€‚ç±»ä¼¼çš„ï¼Œæ›´é«˜ä¸€å±‚ï¼Œå…¬å¸ä¹‹é—´ä¹Ÿå­˜åœ¨å¤§é‡çš„åä½œå…³ç³»ã€‚ä¸€ä¸ªæ±½è½¦ä¾›åº”é“¾å¯èƒ½åŒ…æ‹¬å‡ åƒä¸ªä¼ä¸šï¼Œç»„æˆäº†ä¸€ä¸ªå•†ä¸šç½‘ç»œã€‚é€šè¿‡è¿™ç§æ¾æ•£çš„åä½œå…³ç³»ç»´ç³»çš„ç³»ç»Ÿå¯ä»¥æ— é™æ‰©å±•ä¸‹å»ï¼Œå½¢æˆåºå¤§çš„ï¼Œå¤æ‚çš„ç³»ç»Ÿã€‚è¿™å°±æ˜¯ OOP æƒ³è¡¨è¾¾çš„æ€æƒ³ã€‚

### é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰

> é¢å‘åˆ‡é¢ç¼–ç¨‹(Aspect Oriented Programmingï¼ŒAOPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³

AOP æŠ€æœ¯åˆ©ç”¨ä¸€ç§ç§°ä¸ºâ€œæ¨ªåˆ‡â€çš„æŠ€æœ¯ï¼Œå‰–è§£å¼€å°è£…å¯¹è±¡çš„å†…éƒ¨ï¼Œå°†å½±å“å¤šä¸ªç±»çš„å…¬å…±è¡Œä¸ºå°è£…åˆ°ä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º `Aspect` åˆ‡é¢ã€‚æ‰€è°“çš„åˆ‡é¢ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘ï¼Œå°†å…¶å°è£…èµ·æ¥ä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—çš„è€¦åˆåº¦ï¼Œæœ‰åˆ©ç”¨æœªæ¥çš„å¯æ“ä½œæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

> ä¸­é—´ä»¶ï¼ˆæ´‹è‘±æ¨¡å‹ï¼‰å°±æ˜¯ä¸€ç§ç»å…¸çš„é¢å‘åˆ‡é¢æŠ€æœ¯

![OIP-C](../images/OIP-C.jpeg)

### æ¨¡å—åŒ–å¼€å‘

## æ¶æ„

### æ¶æ„å›¾

> ä»åŠŸèƒ½ä¸Šæ¥çœ‹ï¼Œ``Nest-Server`` çš„æ•´ä½“èƒ½åŠ›å¯ä»¥åˆ’åˆ†ä¸ºå››å±‚ï¼š

- Common å…¨å±€å…¬ç”¨çº¦å®šç›®å½•
- `CoreModule` æ ¸å¿ƒ `IOC` å®¹å™¨ & å¯åŠ¨ç¨‹åº
- Extends æ‹“å±•æ¨¡å—
- Modules ä¸šåŠ¡æ¨¡å—

![Architecture](../images/server.png)
