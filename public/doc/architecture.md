# ğŸ“š æ•´ä½“ä»‹ç»

## åŸºæœ¬æ¦‚å¿µ

### æ¨¡å—

> NestJs ä¸­çš„æ¨¡å— [Module](https://docs.nestjs.cn/7/modules)

é™¤äº† `Core-Module` å¤–ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æä¾›å¯¹å¤–åˆ†äº«çš„èƒ½åŠ›ï¼›ä¸€æ—¦åˆ›å»ºå°±èƒ½è¢«ä»»æ„æ¨¡å—å¤ç”¨/å¼•ç”¨ã€‚æ¨¡å—æ˜¯å•ä¾‹ï¼Œå› æ­¤å¼€å‘è€…å¯ä»¥è½»æ¾åœ°åœ¨å¤šä¸ªæ¨¡å—ä¹‹é—´å…±äº«åŒä¸€ä¸ªæä¾›è€…å®ä¾‹ã€‚

å…¶ä¸­ï¼Œmodule.ts ä¸­çš„æ¨¡å—æ³¨å†Œè¡¨æ˜¯å…·æœ‰ `@Module()` è£…é¥°å™¨çš„ç±»ã€‚Nest-Server å°†ç”¨å®ƒæ¥ç»„ç»‡é€»è¾‘ç»“æ„ä»¥åŠç®¡ç†ä¾èµ–å…³ç³»ã€‚`@Module()` æ¥å—ä¸€ä¸ªæè¿°æ¨¡å—å±æ€§çš„å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§:

- exports	å¯¹å¤–å¯¼å‡ºçš„`æä¾›è€…`åˆ—è¡¨
- imports	å¤–éƒ¨å¯¼å…¥çš„`æ¨¡å—`åˆ—è¡¨
- controllers	æ¨¡å—å†…ä½¿ç”¨çš„`æ§åˆ¶å™¨`åˆ—è¡¨
- providers	æ¨¡å—å†…ä½¿ç”¨çš„`æä¾›è€…`åˆ—è¡¨

### çº¦å®šç›®å½•ï¼ˆCommonï¼‰

> æ¯ä¸ªæ¨¡å—ä¸­éƒ½å¯ä»¥æœ‰è‡ªå·±ç›´å±çš„ common å±‚ï¼Œç”¨äºå­˜æ”¾ç§æœ‰å®šä¹‰ï¼Œ`src` ä¸‹çš„ `common` ç”¨äºå­˜æ”¾å…¨å±€é€šç”¨çš„å®šä¹‰ä¿¡æ¯ï¼Œä½†æ˜¯ä»–ä»¬éƒ½åŒ…å«:

```
* base      â€”â€” å®šä¹‰åŸºç±»ï¼ˆbase classï¼‰
* constant  â€”â€” å®šä¹‰å¸¸é‡ï¼ˆobject/map/arrayï¼‰
* enum      â€”â€” å®šä¹‰æšä¸¾å€¼
* interface â€”â€” å®šä¹‰æ¥å£
* type      â€”â€” å®šä¹‰ç±»å‹
```

### èµ„æºç›®å½•ï¼ˆSharedï¼‰

> ç”¨äºå­˜æ”¾æ¨¡å—ä¸­çš„å…¬å…±èµ„æº

å¤šç”¨äºå­˜æ”¾ Entity/Repository çš„å®šä¹‰ï¼Œä¾‹å¦‚ sequelize model

### æ§åˆ¶å±‚ï¼ˆControllerï¼‰

> NestJs ä¸­çš„æ§åˆ¶å™¨ [Controller](https://docs.nestjs.cn/7/controllers)

æ§åˆ¶å±‚è´Ÿè´£å¤„ç†ä¼ å…¥çš„è¯·æ±‚å’Œå‘å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚é€šå¸¸ï¼Œæ¯ä¸ªæ§åˆ¶å™¨æœ‰å¤šä¸ªè·¯ç”±ï¼Œä¸åŒçš„è·¯ç”±å¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚

### ä¸šåŠ¡å±‚/æä¾›è€…ï¼ˆService/Providerï¼‰

> NestJs ä¸­çš„æä¾›è€… [Controller](https://docs.nestjs.cn/7/providers)

Provider åªæ˜¯ä¸€ä¸ªç”¨ `@Injectable()` è£…é¥°å™¨æ³¨é‡Šçš„ç±»ã€‚
Provider æ˜¯ Nest-Server ä¸­çš„åŸºç¡€ï¼Œæ ¹æ®ä½¿ç”¨ç­–ç•¥/æ¶æ„åˆ†å±‚ï¼Œå¯ä»¥è¢«åˆ†ç±»ä¸º:

- Service ä¸šåŠ¡å±‚
- Provider åŸºç¡€ä¸šåŠ¡/åŠŸèƒ½æä¾›è€…

ä»–ä»¬éƒ½å¯ä»¥é€šè¿‡ constructor æ³¨å…¥ä¾èµ–å…³ç³»ã€‚ è¿™æ„å‘³ç€å¯¹è±¡å¯ä»¥å½¼æ­¤åˆ›å»ºå„ç§å…³ç³»ï¼Œå¹¶ä¸”â€œè¿æ¥â€å¯¹è±¡å®ä¾‹çš„åŠŸèƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥å§”æ‰˜ç»™ `Nest-Server IOC å®¹å™¨`ã€‚ 

### åˆ‡é¢å±‚ (AOP)

- [* Middleware ä¸­é—´ä»¶](https://docs.nestjs.cn/7/middlewares)
- [* Decorator è£…é¥°å™¨](https://docs.nestjs.cn/7/customdecorators)
- [* Filter å¼‚å¸¸è¿‡æ»¤å™¨](https://docs.nestjs.cn/7/exceptionfilters)
- [* Intercetor æ‹¦æˆªå™¨](https://docs.nestjs.cn/7/interceptors)
- [* Pipe ç®¡é“](https://docs.nestjs.cn/7/pipes)
- [* Guard å®ˆå«](https://docs.nestjs.cn/7/guards)

### æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰

> æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆData Transger Object - DTOï¼‰

æŒ‡æœåŠ¡ç«¯è¯·æ±‚è¿‡ç¨‹ä¸­çš„æ•°æ®è½½ä½“

### ä¸šåŠ¡æ•°æ®å¯¹è±¡ï¼ˆBOï¼‰

> ä¸šåŠ¡å¯¹è±¡ï¼ˆBusiness Object - BOï¼‰

æŒ‡æœåŠ¡ç«¯åœ¨ä¸šåŠ¡å±‚å¤„ç†é€»è¾‘åï¼Œå¯¹å¤–è¾“å‡ºçš„æ•°æ®

### æ¶æ„å›¾

![Architecture](../images/server.png)

### ç›®å½•

```
.
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ common
â”‚   â”‚   â”œâ”€â”€ constant.ts
â”‚   â”‚   â”œâ”€â”€ enum.ts
â”‚   â”‚   â”œâ”€â”€ interface.ts
â”‚   â”‚   â””â”€â”€ type.ts
â”‚   â”œâ”€â”€ core
â”‚   â”‚   â”œâ”€â”€ app.ts
â”‚   â”‚   â”œâ”€â”€ module.ts
â”‚   â”‚   â”œâ”€â”€ decorator
â”‚   â”‚   â”œâ”€â”€ filter
â”‚   â”‚   â”œâ”€â”€ intercetor
â”‚   â”‚   â””â”€â”€ pipe
â”‚   â”œâ”€â”€ extends
â”‚   â”‚   â”œâ”€â”€ config
â”‚   â”‚   â”œâ”€â”€ http-client
â”‚   â”‚   â”œâ”€â”€ logger
â”‚   â”‚   â”œâ”€â”€ sequelize
â”‚   â”‚   â”œâ”€â”€ swagger
â”‚   â”‚   â””â”€â”€ utils
â”‚   â”œâ”€â”€ modules
â”‚   â”‚   â””â”€â”€ default
â”‚   â””â”€â”€ main.ts
```